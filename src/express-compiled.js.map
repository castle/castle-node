{"version":3,"sources":["express.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;AAIb,MAAM,CAAC,OAAO,GAAG,UAAU,MAAM,EAAmB;QAAjB,MAAM;;AACrC,WAAO,UAAU,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE;AACtC,iBAAS,gBAAgB,CAAC,IAAI,EAAE;AAC5B,gBAAI,CAAC,OAAO,GAAK,OAAO,CAAC,OAAO,IAAI,SAAS,CAAC;AAC9C,gBAAI,CAAC,EAAE,GAAU,OAAO,CAAC,EAAE,IAAI,SAAS,CAAC;AACzC,gBAAI,CAAC,MAAM,GAAM,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,SAAS,CAAC;AACvD,gBAAI,CAAC,SAAS,GAAG,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;AACrD,mBAAO,IAAI,CAAC;SACf;;AAED,eAAO,CAAC,gBAAgB,GAAG,UAAU,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;AACzD,mBAAO,MAAM,CAAC,UAAU,CAAC,gBAAgB,CAAC;AACtC,qBAAK,EAAL,KAAK;AACL,sBAAM,EAAN,MAAM;AACN,uBAAO,EAAP,OAAO;aACV,CAAC,CAAC,CAAC;SACP,CAAC;;AAEF,eAAO,CAAC,cAAc,GAAG,UAAU,OAAO,EAAE,SAAS,EAAE;AACnD,mBAAO,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC;AACpC,uBAAO,EAAP,OAAO;AACP,yBAAS,EAAT,SAAS;aACZ,CAAC,CAAC,CAAC;SACP,CAAC;;AAEF,eAAO,CAAC,YAAY,GAAG,MAAM,CAAC;;AAE9B,YAAI,EAAE,CAAC;KACV,CAAA;CACJ,CAAC","file":"express-compiled.js","sourcesContent":["'use strict';\n\nimport Events from './events-compiled.js';\n\nmodule.exports = function (castle, events = Events) {\n    return function (request, response, next) {\n        function injectClientData(data) {\n            data.headers   = request.headers || undefined;\n            data.ip        = request.ip || undefined;\n            data.cookie    = request.cookies['__cid'] || undefined;\n            data.userAgent = request.headers['user-agent'] || '';\n            return data;\n        }\n\n        request.castleTrackEvent = function (event, userID, details) {\n            return castle.trackEvent(injectClientData({\n                event,\n                userID,\n                details\n            }));\n        };\n\n        request.castleIdentify = function (user_id, user_data) {\n            return castle.identify(injectClientData({\n                user_id,\n                user_data\n            }));\n        };\n\n        request.castleEvents = events;\n\n        next();\n    }\n};\n"]}